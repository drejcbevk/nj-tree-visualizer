import numpy as np

from src.nj_core import neighbor_joining_core
from src.nj_visualization import interactive_tree_view


def demo_4x4_distance_matrix():
    """
    Demo on a 20-taxon NJ example.
    """
    D = np.array([
        [0, 2, 3, 3, 4, 12,13,14,15,15, 19,19,20,21,22, 28,28,29,30,30],
        [2, 0, 3, 4, 4, 12,13,14,15,16, 20,20,21,22,23, 29,29,30,30,31],
        [3, 3, 0, 2, 3, 13,14,15,16,16, 21,22,22,23,23, 30,31,31,32,32],
        [3, 4, 2, 0, 2, 13,14,15,16,17, 21,22,22,24,24, 30,31,32,33,33],
        [4, 4, 3, 2, 0, 14,15,15,17,17, 22,23,23,25,25, 31,32,32,33,34],
        [12,12,13,13,14, 0, 2, 3, 4, 4, 12,13,14,15,15, 18,19,20,20,21],
        [13,13,14,14,15, 2, 0, 3, 4, 5, 13,14,15,16,16, 19,20,21,22,22],
        [14,14,15,15,15, 3, 3, 0, 2, 2, 14,15,16,17,17, 20,20,22,23,23],
        [15,15,16,16,17, 4, 4, 2, 0, 2, 15,16,17,18,18, 21,22,23,24,24],
        [15,16,16,17,17, 4, 5, 2, 2, 0, 16,17,18,19,19, 22,23,24,24,25],
        [19,20,21,21,22,12,13,14,15,16, 0, 2, 3, 4, 4, 14,15,16,17,18],
        [19,20,22,22,23,13,14,15,16,17, 2, 0, 2, 3, 3, 15,16,17,18,18],
        [20,21,22,22,23,14,15,16,17,18, 3, 2, 0, 2, 2, 16,17,17,18,19],
        [21,22,23,24,25,15,16,17,18,19, 4, 3, 2, 0, 2, 17,18,19,20,20],
        [22,23,23,24,25,15,16,17,18,19, 4, 3, 2, 2, 0, 18,19,20,21,22],
        [28,29,30,30,31,18,19,20,21,22, 14,15,16,17,18, 0, 2, 3, 4, 4],
        [28,29,31,31,32,19,20,20,22,23, 15,16,17,18,19, 2, 0, 2, 3, 3],
        [29,30,31,32,32,20,21,22,23,24, 16,17,17,19,20, 3, 2, 0, 2, 2],
        [30,30,32,33,33,20,22,23,24,24, 17,18,18,20,21, 4, 3, 2, 0, 2],
        [30,31,32,33,34,21,22,23,24,25, 18,18,19,20,22, 4, 3, 2, 2, 0]
    ], dtype=float)

    labels = [
        "A1", "A2", "A3", "A4", "A5", "A6", "A7", "A8", "A9", "A10", "A11",
        "A12", "A13", "A14", "A15", "A16", "A17", "A18", "A19", "A20"
    ]

    root = neighbor_joining_core(D, labels)
    interactive_tree_view(root)


if __name__ == "__main__":
    demo_4x4_distance_matrix()